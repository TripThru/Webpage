loadMapPartners = ->
    $.get('http://107.170.240.134/TripThru.TripThruGateway/' + 'fleets?format=json&access_token=' + 'yellow12ondazazxx21', (data) =>
        if data.result == 'OK'
            mapOptions =
                zoom: 4
                center: new google.maps.LatLng(37.09024, -95.712891)
                mapTypeId: google.maps.MapTypeId.TERRAIN

            colors = [ "#006600", "#0D6B00", "#1A7000", "#267500", "#337A00", "#408000", "#4C8500", "#598A00", "#668F00", "#739400", "#809900", "#8C9E00", "#99A300", "#A6A800", "#B2AD00", "#BFB200", "#CCB800", "#D9BD00", "#E6C200", "#F2C700", "#FFCC00", "#FCC200", "#FAB800", "#F7AD00", "#F5A300", "#F29900", "#F08F00", "#ED8500", "#EB7A00", "#E87000", "#E66600", "#E35C00", "#E05200", "#DE4700", "#DB3D00", "#D93300", "#D62900", "#D41F00", "#D11400", "#CF0A00", "#CC0000" ]
            driversTotal = [89,5,37,90,35,18,51,47,31,19,74,10,92,65,65,20,32]
            driver = 0
            map = new google.maps.Map(document.getElementById("map-canvas2"), mapOptions)

            citymap = {}
            count = 0
            data.fleets.forEach (fleet) ->
                if fleet.fleetName == "TripThru San Francisco"
                    return
                driver++
                citymap[fleet.fleetName]=
                    center: new google.maps.LatLng(fleet.coverage[0].center.lat, fleet.coverage[0].center.lng)
                    population: fleet.coverage[0].radius
                    drivers: driversTotal[driver]
                if count < driversTotal[driver]
                    count = driversTotal[driver]

            steps = (colors.length / count)
            cityCircle = undefined
            for city of citymap
                temporalVar = (steps * citymap[city].drivers)
                colorNumber = Math.floor(temporalVar)
                populationOptions =
                    strokeColor: if colorNumber > (colors.length - 1) then colors[colors.length - 1] else colors[colorNumber]
                    strokeOpacity: 0.8
                    strokeWeight: 2
                    fillColor: if colorNumber > (colors.length - 1) then colors[colors.length - 1] else colors[colorNumber]
                    fillOpacity: 0.35
                    map: map
                    center: citymap[city].center
                    radius: citymap[city].population * 1000

                cityCircle = new google.maps.Circle(populationOptions)

    ).error( ->
    )
    return


$('.settings.users').ready ->
    google.maps.event.addDomListener window, "load", loadMapPartners

